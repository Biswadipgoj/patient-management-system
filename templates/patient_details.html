{% extends 'base.html' %}
{% block content %}
<div class="card">
    <h2>Patient Details</h2>
    {% if patient %}
    <div class="patient-details">
        <h3>{{ patient.name }} (Reg. No.: {{ patient.reg_no }})</h3>
        <p><strong>Screening No.:</strong> {{ patient.screening_no }}</p>
        <p><strong>Screening Date:</strong> {{ patient.screening_date }}</p>
        <p><strong>Age:</strong> {{ patient.age }} | <strong>Sex:</strong> {{ patient.sex }}</p>
        <p><strong>Contact No.:</strong> {{ patient.contact_no }} | <strong>Residence:</strong> {{ patient.residence }}</p>
        <h4>Baseline Socio-demographic data</h4>
        <p><strong>Duration of suffering from MC:</strong> {{ patient.duration_mc }}</p>
        <p><strong>Co-morbidities:</strong> {{ patient.co_morbidities }}</p>
        <p><strong>Risk factors:</strong> {{ patient.risk_factors }}</p>
        <p><strong>Treatment taken:</strong> {{ patient.treatment_taken }}</p>
        <p><strong>Weight:</strong> {{ patient.weight_kg }} kg | <strong>Height:</strong> {{ patient.height_cm }} cm</p>
        <p><strong>Education status:</strong> {{ patient.education_status }}</p>
        <p><strong>Socio-economic status:</strong> {{ patient.socio_economic_status }}</p>
    </div>
    
    <div class="card">
        <h2>Baseline Treatment Details</h2>
        {% if patient.baseline_treatment %}
        <p><strong>Date:</strong> {{ patient.baseline_treatment.date }}</p>
        <p><strong>Present Complaint:</strong> {{ patient.baseline_treatment.present_complaint }}</p>
        <p><strong>Prescription:</strong> {{ patient.baseline_treatment.prescription }}</p>
        {% else %}
        <p>No baseline treatment data found.</p>
        {% endif %}
    </div>

    <div class="outcome-assessment-history">
        <h2>Outcome Assessment History</h2>
        {% if assessments|length > 0 %}
            {% for oa in assessments %}
            <div class="outcome-assessment-item">
                <h4>Assessment {{ oa.assessment_number }} ({{ oa.date }})</h4>
                <p><strong>Brief notes:</strong> {{ oa.brief_notes }}</p>
                <p><strong>Prescription:</strong> {{ oa.prescription }}</p>
                <h4>ORIDL</h4>
                <p><strong>Main Complaint:</strong> {{ oa.oridl_main_complaint }}</p>
                <p><strong>Overall Well-being:</strong> {{ oa.oridl_wellbeing }}</p>
            </div>
            {% endfor %}
        {% else %}
            <p>No Outcome Assessment data found.</p>
        {% endif %}
    </div>
    {% if assessments|length < 6 %}
    <div class="card">
        <h3>Add New Outcome Assessment {{ assessments|length + 1 }}</h3>
        <a href="{{ url_for('add_outcome_assessment', patient_id=patient.id) }}" class="nav-button" style="width: auto;">Go to Assessment {{ assessments|length + 1 }}</a>
    </div>
    {% else %}
    <p>Maximum of 6 Outcome Assessments reached.</p>
    {% endif %}

    {% else %}
    <p class="error-message">Patient not found.</p>
    {% endif %}
</div>
{% endblock %}
